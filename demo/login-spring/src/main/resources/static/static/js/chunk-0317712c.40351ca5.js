(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0317712c"],{"9aaf":function(e,t,o){"use strict";o("df8c")},d4ba:function(e,t,o){"use strict";o("dc63")},dc63:function(e,t,o){},dd7b:function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login",style:"background-image:url("+e.Background+");"},[t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"label-position":"left","label-width":"0px"}},[t("h3",{staticClass:"title"},[e._v("欢迎使用")]),t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"账号"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}},[t("svg-icon",{staticClass:"el-input__icon input-icon",attrs:{slot:"prefix","icon-class":"user"},slot:"prefix"})],1)],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[t("svg-icon",{staticClass:"el-input__icon input-icon",attrs:{slot:"prefix","icon-class":"password"},slot:"prefix"})],1)],1),t("el-form-item",{attrs:{prop:"code"}},[t("el-input",{staticStyle:{float:"left",width:"66%"},attrs:{"auto-complete":"off",placeholder:"验证码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}},[t("svg-icon",{staticClass:"el-input__icon input-icon",attrs:{slot:"prefix","icon-class":"validCode"},slot:"prefix"})],1),t("div",{staticClass:"login-code",on:{click:e.getCode}},[t("valid-code",{attrs:{identifyCode:e.identifyCode}})],1)],1),t("el-checkbox",{staticStyle:{float:"left",margin:"0 0 25px 0"},model:{value:e.loginForm.rememberMe,callback:function(t){e.$set(e.loginForm,"rememberMe",t)},expression:"loginForm.rememberMe"}},[e._v(" 记住我 ")]),t("el-form-item",{staticStyle:{width:"100%"}},[t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,size:"medium",type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e.loading?t("span",[e._v("登 录 中...")]):t("span",[e._v("登 录")])])],1),t("p",{staticStyle:{float:"right","font-size":"13px"}},[e._v(" 还没有帐号？ "),t("a",{staticClass:"register",attrs:{href:"/register"}},[e._v("注册")])])],1)],1)},s=[],n=o("720d"),r=o.n(n);const a="MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANL378k3RiZHWx5AfJqdH9xRNBmD9wGD\n2iRe41HdTNF8RUhNnHit5NpMNtGL0NPTSSpPjjI1kJfVorRvaQerUgkCAwEAAQ==";function l(e){const t=new r.a;return t.setPublicKey(a),t.encrypt(e)}var d=o("852e"),m=o.n(d),c=function(){var e=this;e._self._c;return e._m(0)},u=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"canvas"},[t("canvas",{staticClass:"validCode",attrs:{id:"canvas"}})])}],h={name:"ValidCode",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:130},fontSizeMax:{type:Number,default:140}},methods:{randomNum(e,t){return Math.floor(Math.random()*(t-e)+e)},randomColor(e,t){const o=this.randomNum(e,t),i=this.randomNum(e,t),s=this.randomNum(e,t);return"rgb("+o+","+i+","+s+")"},drawPic(){const e=document.getElementById("canvas"),t=e.getContext("2d");t.textBaseline="bottom",t.fillStyle="#e6ecfd",t.fillRect(0,0,e.width,e.height);for(let o=0;o<this.identifyCode.length;o++)this.drawText(t,this.identifyCode[o],o);this.drawLine(t),this.drawDot(t)},drawText(e,t,o){const i=document.getElementById("canvas");e.fillStyle=this.randomColor(50,160),e.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";const s=(o+.5)*(i.width/(this.identifyCode.length+1)),n=this.randomNum(this.fontSizeMax,i.height-5);var r=this.randomNum(-30,30);e.translate(s,n),e.rotate(r*Math.PI/180),e.fillText(t,0,0),e.rotate(-r*Math.PI/180),e.translate(-s,-n)},drawLine(e){const t=document.getElementById("canvas");for(let o=0;o<4;o++)e.strokeStyle=this.randomColor(100,200),e.beginPath(),e.moveTo(this.randomNum(0,t.width),this.randomNum(0,t.height)),e.lineTo(this.randomNum(0,t.width),this.randomNum(0,t.height)),e.lineWidth=3,e.stroke()},drawDot(e){const t=document.getElementById("canvas");for(let o=0;o<30;o++)e.fillStyle=this.randomColor(0,255),e.beginPath(),e.arc(this.randomNum(0,t.width),this.randomNum(0,t.height),3,0,2*Math.PI),e.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},p=h,g=(o("d4ba"),o("2877")),f=Object(g["a"])(p,c,u,!1,null,"f7691760",null),y=f.exports,w=o("f1b4"),v=o.n(w),C={components:{validCode:y},name:"Login",data(){return{Background:v.a,identifyCodes:"1234567890abcdefjhijk1234567890linopqrsduvwxyz",identifyCode:"",cookiePass:"",loginForm:{username:"",password:"",rememberMe:!1,code:"",uuid:""},loginRules:{username:[{required:!0,trigger:"blur",message:"用户名不能为空"}],password:[{required:!0,trigger:"blur",message:"密码不能为空"}],code:[{required:!0,trigger:"change",message:"验证码不能为空"}]},loading:!1,redirect:void 0}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},created(){this.getCode(),this.getCookie(),this.point()},methods:{getCode(){this.identifyCode="";for(let e=0;e<4;e++)this.identifyCode+=this.identifyCodes[this.randomNum(0,this.identifyCodes.length)];console.log(this.identifyCode)},randomNum(e,t){return Math.floor(Math.random()*(t-e)+e)},getCookie(){const e=m.a.get("username");let t=m.a.get("password");const o=m.a.get("rememberMe");this.cookiePass=void 0===t?"":t,t=void 0===t?this.loginForm.password:t,this.loginForm={username:void 0===e?this.loginForm.username:e,password:t,rememberMe:void 0!==o&&Boolean(o),code:""}},async handleLogin(){this.$refs.loginForm.validate(async e=>{const t={username:this.loginForm.username,password:this.loginForm.password,rememberMe:this.loginForm.rememberMe,code:this.loginForm.code,uuid:this.loginForm.uuid};if(t.password!==this.cookiePass&&(t.password=l(t.password)),!e)return console.log("error submit!!"),!1;this.loading=!0,t.rememberMe?(m.a.set("username",t.username,{expires:1}),m.a.set("password",t.password,{expires:1}),m.a.set("rememberMe",t.rememberMe,{expires:1})):(m.a.remove("username"),m.a.remove("password"),m.a.remove("rememberMe"));try{const e=await this.$axios.post("/login",t);200===e.status?(this.$message({showClose:!0,message:"登录成功，正在跳转到主页...",type:"success"}),setTimeout(()=>{this.loading=!1,window.location.href="/index"},2e3)):(this.$message({showClose:!0,message:e.data||"登录失败",type:"error"}),this.loading=!1)}catch(o){console.error("登录失败:",o),this.$message({showClose:!0,message:"登录失败，请稍后重试",type:"error"}),this.loading=!1}})},point(){const e=void 0!==m.a.get("point");e&&(this.$notify({title:"提示",message:"当前登录状态已过期，请重新登录！",type:"warning",duration:5e3}),m.a.remove("point"))}}},b=C,x=(o("9aaf"),Object(g["a"])(b,i,s,!1,null,"6ee8e01c",null));t["default"]=x.exports},df8c:function(e,t,o){},f1b4:function(e,t,o){e.exports=o.p+"static/img/top-scm.a396789a.jpg"}}]);